<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>一个搜索框加显示结果</title>
</head>
<body>
	<p>使用react创建一个应用组件
	1.拆分用户界面为一个组件树
	2.利用react，创建应用的一个静态版本
	tip:props是一种父级向子级传递数据的方式
		不要使用state来构建静态版本，仅仅用于实现交互功能
		在简单的应用中，从上到下的方式更加简单；在大型项目中，从下到上更加简单，并且容易测试
	3.识别出最小的（但是完整的）代表ui的state
	4.确认state的声明周期

	5.添加反向数据流


	</p>
	<script src="http://cdn.gbtags.com/react/0.12.2/react.js"></script>
<script src="http://cdn.gbtags.com/react/0.12.2/JSXTransformer.js"></script>

	<div id="container">
	    <!-- This element's contents will be replaced with your component. -->
	</div>
	<p>创建应用先分析要什么组件，画出树形结构。确定包含在其他组件中的属性</p>
	<script type="text/jsx">
		
		var ProductCategoryRow = React.createClass({
			render: function  () {
				return (
					<tr>
					    <th colSpan="2">{this.props.category}</th>
					</tr>
				)
			}
		})

		var ProductRow = React.createClass({
			render: function  () {
				var name = this.props.product.stocked ? this.props.product.name : <span style={{color: 'red'}}>{this.props.product.name}</span>;
				return (
					<tr>
						<td>{name}</td>
						<td>{this.props.product.price}</td>
					</tr>
				);
			}
		});

		var ProductTable = React.createClass({
			render: function  () {
				var rows = [];
				var lastCategory = null;
				this.props.products.forEach(function  (product) {
					if (product.name.indexOf(this.props.filterText) === -1 || (!product.stocked && this.props.inStockOnly)) {
						return ;
					}

					if(product.category !== lastCategory) {

						rows.push(<ProductCategoryRow category={product.category} key={product.category} />);
					}
					rows.push(<ProductRow product={product} key={product.name} />);
					lastCategory = product.category;
			    }.bind(this));

				return (
					<table>
						<thead>
							<tr>
								<th>Name</th>
								<th>Price</th>
							</tr>
						</thead>
						<tbody>{rows}</tbody>
					</table>
				)
			}
		})


		var SearchBar = React.createClass({
			handleChange: function  () {
				this.props.onUserInput(
					this.refs.filterTextInput.value,
					this.refs.inStockOnlyInput.checked
				)
			},

			render: function  () {
				return (
					<form>
						<input placeholder="Search..." value={this.props.filterText} ref="filterTextInput"/>
						<p>
							<input type="checkbox" checked={this.props.inStockOnly} ref="inStockOnlyInput" onChange={this.handleChange}/>
							{''}
							Only show products stock
						</p>
					</form>
				)
			}
		})



		var FilterableProductTable = React.createClass({
			getInitialState: function  () {
				return {
					filterText: '',
					inStockOnly: false
				}
			},

			handleUserInput: function  (filterText, inStockOnly) {
				this.setState({
					filterText: filterText,
					inStockOnly: inStockOnly
				})
			},

			render: function  () {
				return (
					<div>
						<SearchBar 
						  filterText={this.state.filterText}
						  inStockOnly={this.state.inStockOnly} 
						  onUserInput={this.handleUserInput} />
						<ProductTable 
						  products={this.props.products}
						  filterText={this.state.filterText}
						  inStockOnly={this.state.inStockOnly}  />
					</div>
				)
			}

		})

		var PRODUCTS = [
		  {category: 'Sporting Goods', price: '$49.99', stocked: true, name: 'Football'},
		  {category: 'Sporting Goods', price: '$9.99', stocked: true, name: 'Baseball'},
		  {category: 'Sporting Goods', price: '$29.99', stocked: false, name: 'Basketball'},
		  {category: 'Electronics', price: '$99.99', stocked: true, name: 'iPod Touch'},
		  {category: 'Electronics', price: '$399.99', stocked: false, name: 'iPhone 5'},
		  {category: 'Electronics', price: '$199.99', stocked: true, name: 'Nexus 7'}
		];

		React.render(
			<FilterableProductTable products={PRODUCTS} />,document.getElementById('container')
		)




	</script>
</body>
</html>